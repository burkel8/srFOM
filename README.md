# Sketched Recycled FOM (srFOM) 

A library which implements recycled FOM (rFOM), and sketeched-recycled FOM (srFOM) proposed in [1] for sequences of matrix function applications.

## Tests
All test scripts used to generate the plots in [1] can be found in the Tests folder. These files are:

test_quad_v_closed: compares the closed form formulation of recycled FOM against the quadrature based implementation 
presented in [2].

test_inv_sqrt1.m: runs the inverse square root example while computing A*U between problems.

test_inv_sqrt2.m: runs the inverse square root example while avoiding computation of A*U between problems.

test_exp.m: runs the exponential example.

test_inv.m: runs the inverse example.

The initial run of files test_quad_v_closed.m, test_inv_sqrt1.m and test_inv_sqrt2.m requires the matrices, vectors and exact solutions to first be generated, which is done inside a conditional if "tilde" 0 statement. Once generated, the data may be saved and loaded in subsequent runs of the code by removing the "tilde" symbol.

## data
The data folder contains the matrices used in the inverse square root, and exponential examples.

## Important note on regenerating results from [1]
The plots in the numerical experiments section of [1] can be regenerated using the test scripts. For examples which produce both

a) A plot of the error AND
b) The value of the Arnoldi cycle length required to reach convergence,

care needs to be taken to ensure the parameters are set correctly to generate the desired plot.

To generate a plot of an error curve for fixed m, one needs to ensure that the tol variable is set small enough such that m iterations will be exected (without early connvergence). Otherwise, the plot of the error will be meaningless. We suggest an unrealistic tolerance such as 1e-20.

Similarily, in order to generate a plot of the Arnoldi cycle length required to reach a specified level of tolerance, the appropriate value of tol needs to be set, but the Arnoldi cycle length m needs to be chosen such that the method converges before the maximum number of iterations is reached. Otherwise the plot will be meaningless. 
Again, we suggest an unrealisticlly high value of m. 

For the above reasons, only one plot generated by each test script will produce meaninful information. 

## References
[1] L. Burke, S. GÃ¼ttel. - Krylov Subspace Recycling With Randomized Sketching For Matrix Functions, arXiv :2308.02290 [math.NA] (2023)

[2]  L. Burke, A. Frommer, G. Ramirez, K. M Soodhalter - Krylov Subspace Recycling For Matrix Functions,
arXiv :2209.14163 [math.NA] (2022)
